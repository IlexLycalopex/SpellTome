<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
<title>Dice Roller â€” The Tome | D&D 5e</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700;900&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&display=swap" rel="stylesheet">
<style>
:root {
  --bg-dark:#1a1a2e; --bg-panel:#16213e; --text-light:#e8e8e8;
  --text-muted:#9a9ab0; --text-dim:#6a6a80;
  --gold:#c9a84c; --gold-dim:#8a6a2c; --border:#2a2a4a;
  --acc:#7b5ea7; --acc-dim:#4a2d7a; --acc-glow:rgba(123,94,167,0.25);
  --acc-bg:rgba(123,94,167,0.08);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
body {
  font-family:'EB Garamond',Georgia,serif;
  background:var(--bg-dark); color:var(--text-light);
  min-height:100vh; overflow-x:hidden;
  background-image:
    radial-gradient(ellipse at 15% 20%, rgba(74,0,120,0.2) 0%, transparent 52%),
    radial-gradient(ellipse at 85% 75%, rgba(0,55,110,0.18) 0%, transparent 52%);
}
body::before {
  content:''; position:fixed; inset:0; pointer-events:none; z-index:0; opacity:0.025;
  background-image:
    repeating-linear-gradient(0deg, transparent, transparent 59px, rgba(201,168,76,1) 59px, rgba(201,168,76,1) 60px),
    repeating-linear-gradient(90deg, transparent, transparent 59px, rgba(201,168,76,1) 59px, rgba(201,168,76,1) 60px);
}

/* NAV DRAWER */
.nav-overlay {
  position:fixed;inset:0;background:rgba(0,0,0,0.55);z-index:998;
  opacity:0;pointer-events:none;transition:opacity 0.25s ease;
}
.nav-overlay.open{opacity:1;pointer-events:all;}
.nav-drawer {
  position:fixed;top:0;right:-310px;width:290px;height:100vh;
  background:rgba(13,20,45,0.99);border-left:1px solid var(--border);
  backdrop-filter:blur(16px);z-index:999;
  transition:right 0.28s cubic-bezier(0.4,0,0.2,1);
  display:flex;flex-direction:column;
}
.nav-drawer.open{right:0;}
.nav-drawer-header {
  display:flex;align-items:center;justify-content:space-between;
  padding:18px 20px;border-bottom:1px solid var(--border);flex-shrink:0;
}
.nav-drawer-title{font-family:'Cinzel',serif;font-size:0.75rem;font-weight:700;letter-spacing:0.18em;text-transform:uppercase;color:var(--gold);}
.nav-close-btn{background:none;border:none;color:var(--text-muted);font-size:1.3rem;cursor:pointer;padding:4px 6px;line-height:1;border-radius:4px;transition:color 0.15s;}
.nav-close-btn:hover{color:var(--text-light);}
.nav-scroll{flex:1;overflow-y:auto;padding:8px 0 24px;}
.nav-section-label{font-family:'Cinzel',serif;font-size:0.58rem;font-weight:700;letter-spacing:0.22em;text-transform:uppercase;color:var(--text-dim);padding:16px 20px 6px;display:block;}
.nav-item{display:flex;align-items:center;gap:12px;padding:11px 20px;text-decoration:none;color:var(--text-muted);font-family:'Cinzel',serif;font-size:0.75rem;font-weight:600;letter-spacing:0.07em;text-transform:uppercase;border-left:3px solid transparent;transition:all 0.14s;}
.nav-item:hover,.nav-item.active{color:var(--gold);background:rgba(201,168,76,0.07);border-left-color:var(--gold-dim);}
.nav-item .ni{width:1.1rem;height:1.1rem;flex-shrink:0;opacity:0.75;}
.nav-item:hover .ni,.nav-item.active .ni{opacity:1;}
.hamburger-btn{background:none;border:1px solid var(--border);border-radius:6px;padding:7px 10px;cursor:pointer;display:flex;flex-direction:column;gap:5px;transition:border-color 0.15s;flex-shrink:0;}
.hamburger-btn:hover{border-color:var(--gold-dim);}
.hamburger-btn span{display:block;width:20px;height:2px;background:var(--text-muted);border-radius:2px;transition:background 0.15s;}
.hamburger-btn:hover span{background:var(--gold);}

/* SITE HEADER */
#site-header {
  position:sticky;top:0;z-index:100;
  background:rgba(22,33,62,0.97);border-bottom:1px solid var(--border);
  backdrop-filter:blur(12px);
  display:flex;align-items:center;justify-content:space-between;
  padding:12px 20px;
}
.site-logo{display:flex;align-items:center;gap:9px;font-family:'Cinzel',serif;font-size:1rem;font-weight:900;letter-spacing:0.1em;text-transform:uppercase;color:var(--gold);text-shadow:0 0 18px rgba(201,168,76,0.35);text-decoration:none;}
.site-logo svg{width:1.2rem;height:1.2rem;flex-shrink:0;}
.page-title{font-family:'Cinzel',serif;font-size:0.72rem;font-weight:700;letter-spacing:0.18em;text-transform:uppercase;color:var(--acc);opacity:0.9;}

/* PAGE */
.page-wrap{position:relative;z-index:1;min-height:calc(100vh - 52px);display:flex;flex-direction:column;}
.content-wrap{max-width:760px;margin:0 auto;width:100%;padding:32px 20px 60px;}

/* PAGE HEADING */
.page-heading{font-family:'Cinzel',serif;font-size:clamp(1.5rem,4vw,2.4rem);font-weight:900;letter-spacing:0.08em;text-transform:uppercase;color:var(--gold);line-height:1.05;margin-bottom:6px;text-shadow:0 0 30px rgba(201,168,76,0.25),0 2px 6px rgba(0,0,0,0.7);}
.page-sub{font-size:1rem;color:var(--text-muted);font-style:italic;letter-spacing:0.03em;margin-bottom:28px;}

/* PANEL */
.panel{background:rgba(22,33,62,0.65);border:1px solid var(--border);border-radius:10px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,0.4);backdrop-filter:blur(8px);margin-bottom:18px;}
.panel-head{padding:14px 18px 12px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:rgba(22,33,62,0.5);}
.panel-title{font-family:'Cinzel',serif;font-size:0.68rem;font-weight:700;letter-spacing:0.2em;text-transform:uppercase;color:var(--text-dim);}
.panel-body{padding:18px;}

/* DICE GRID */
.dice-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:20px;}
.dice-btn{font-family:'Cinzel',serif;font-size:1rem;font-weight:700;letter-spacing:0.06em;padding:16px 10px;border-radius:8px;border:1px solid rgba(123,94,167,0.35);background:rgba(123,94,167,0.12);color:var(--text-light);cursor:pointer;transition:background 0.14s ease,border-color 0.14s ease,transform 0.06s ease,box-shadow 0.14s;user-select:none;}
.dice-btn:hover{background:rgba(123,94,167,0.28);border-color:rgba(123,94,167,0.65);box-shadow:0 0 14px rgba(123,94,167,0.2);}
.dice-btn:active{transform:translateY(1px);}

/* FORM */
.field-label{font-family:'Cinzel',serif;font-size:0.6rem;font-weight:700;letter-spacing:0.18em;text-transform:uppercase;color:var(--text-dim);display:block;margin-bottom:8px;}
.field-input{width:100%;padding:12px 14px;border-radius:7px;border:1px solid var(--border);background:rgba(0,0,0,0.3);color:var(--text-light);font-family:'EB Garamond',Georgia,serif;font-size:1rem;transition:border-color 0.15s;}
.field-input:focus{outline:none;border-color:var(--acc);}
.field-hint{font-size:0.82rem;color:var(--text-dim);font-style:italic;margin-top:6px;}
.roll-row{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:end;margin-top:14px;}
.roll-btn{font-family:'Cinzel',serif;font-size:0.75rem;font-weight:700;letter-spacing:0.12em;text-transform:uppercase;padding:12px 22px;border-radius:7px;border:1px solid var(--gold-dim);background:linear-gradient(135deg,rgba(138,106,44,0.5),rgba(201,168,76,0.2));color:var(--gold);cursor:pointer;transition:all 0.14s;white-space:nowrap;}
.roll-btn:hover{background:linear-gradient(135deg,rgba(138,106,44,0.8),rgba(201,168,76,0.35));box-shadow:0 0 16px rgba(201,168,76,0.2);}
.roll-btn:active{transform:translateY(1px);}

/* RESULT */
.result-wrap{margin-top:20px;padding-top:18px;border-top:1px solid var(--border);}
.result-total{font-family:'Cinzel',serif;font-size:clamp(2.8rem,8vw,4.5rem);font-weight:900;color:var(--gold);line-height:1;text-shadow:0 0 30px rgba(201,168,76,0.45);}
.result-total.roll-flash{animation:flash-in 0.28s ease;}
@keyframes flash-in{0%{transform:scale(1.12);opacity:0.6;}100%{transform:scale(1);opacity:1;}}
.result-detail{margin-top:8px;font-size:0.9rem;color:var(--text-muted);font-style:italic;}

/* HISTORY */
.hist-clear-btn{font-family:'Cinzel',serif;font-size:0.62rem;font-weight:700;letter-spacing:0.1em;text-transform:uppercase;padding:7px 14px;border-radius:6px;border:1px solid rgba(192,57,43,0.4);background:rgba(192,57,43,0.1);color:#e07060;cursor:pointer;transition:all 0.14s;}
.hist-clear-btn:hover{background:rgba(192,57,43,0.25);border-color:rgba(192,57,43,0.65);}
.history-item{font-size:0.9rem;padding:10px 13px;border:1px solid rgba(255,255,255,0.07);border-radius:7px;margin-bottom:8px;background:rgba(255,255,255,0.03);color:var(--text-muted);line-height:1.4;font-family:'EB Garamond',Georgia,serif;}
.history-item:last-child{margin-bottom:0;}
.hist-total{color:var(--gold);font-weight:600;}
.hist-empty{font-size:0.9rem;color:var(--text-dim);font-style:italic;}

/* FOOTER */
.site-footer{margin-top:auto;position:relative;z-index:1;padding:24px 20px;border-top:1px solid var(--border);text-align:center;font-size:0.78rem;color:var(--text-dim);font-style:italic;background:rgba(16,24,50,0.45);}

@media(max-width:640px){
  #site-header{padding:10px 16px;}
  .content-wrap{padding:22px 14px 48px;}
  .dice-grid{grid-template-columns:repeat(3,1fr);}
}
</style>
</head>
<body>

<div class="nav-overlay" id="nav-overlay" onclick="closeNav()"></div>
<nav class="nav-drawer" id="nav-drawer" aria-label="Site navigation">
  <div class="nav-drawer-header">
    <span class="nav-drawer-title">The Tome</span>
    <button class="nav-close-btn" onclick="closeNav()" aria-label="Close">&#x2715;</button>
  </div>
  <div class="nav-scroll">
    <span class="nav-section-label">Home</span>
    <a href="index.html" class="nav-item">
      <svg class="ni" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
      &nbsp;Hub
    </a>
    <span class="nav-section-label">Reference</span>
    <a href="spelltome.html" class="nav-item">
      <svg class="ni" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
      &nbsp;Spell Tome
    </a>
    <a href="conditions.html" class="nav-item">
      <svg class="ni" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
      &nbsp;Condition Codex
    </a>
    <a href="wildshape.html" class="nav-item">
      <svg class="ni" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10z"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></svg>
      &nbsp;Wildshape &amp; Familiar
    </a>
    <a href="monsters.html" class="nav-item">
      <svg class="ni" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="9" cy="12" r="1"/><circle cx="15" cy="12" r="1"/><path d="M8 20v2h8v-2"/><path d="M12.5 17h-1a1 1 0 0 0-1 1v2h3v-2a1 1 0 0 0-1-1z"/><path d="M12 2C6.5 2 2 6.5 2 12c0 3.04 1.36 5.75 3.5 7.59V20h13v-.41C20.64 17.75 22 15.04 22 12 22 6.5 17.5 2 12 2z"/></svg>
      &nbsp;Monster Codex
    </a>
    <a href="magic-items.html" class="nav-item">
      <svg class="ni" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polygon points="6 3 18 3 22 9 12 22 2 9"/><line x1="2" y1="9" x2="22" y2="9"/><line x1="12" y1="3" x2="6" y2="9"/><line x1="12" y1="3" x2="18" y2="9"/></svg>
      &nbsp;Magic Item Compendium
    </a>
    <span class="nav-section-label">Table Tools</span>
    <a href="combat-tracker.html" class="nav-item">
      <svg class="ni" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" y1="19" x2="19" y2="13"/><line x1="16" y1="16" x2="20" y2="20"/><line x1="19" y1="21" x2="21" y2="19"/><polyline points="14.5 6.5 18 3 21 3 21 6 17.5 9.5"/><line x1="5" y1="14" x2="9" y2="18"/><line x1="7" y1="17" x2="3" y2="21"/><line x1="3" y1="19" x2="5" y2="21"/></svg>
      &nbsp;Combat Tracker
    </a>
    <a href="dice-roller.html" class="nav-item active">
      <svg class="ni" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect x="3" y="3" width="8" height="8" rx="1.5"/><rect x="13" y="3" width="8" height="8" rx="1.5"/><rect x="3" y="13" width="8" height="8" rx="1.5"/><rect x="13" y="13" width="8" height="8" rx="1.5"/><circle cx="7" cy="7" r="1" fill="currentColor" stroke="none"/><circle cx="17" cy="7" r="1" fill="currentColor" stroke="none"/><circle cx="7" cy="17" r="1" fill="currentColor" stroke="none"/><circle cx="17" cy="17" r="1" fill="currentColor" stroke="none"/></svg>
      &nbsp;Dice Roller
    </a>
  </div>
</nav>

<header id="site-header">
  <a href="index.html" class="site-logo">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
    The Tome
  </a>
  <span class="page-title">Dice Roller</span>
  <button class="hamburger-btn" onclick="openNav()" aria-label="Open navigation">
    <span></span><span></span><span></span>
  </button>
</header>

<div class="page-wrap">
  <div class="content-wrap">

    <div class="page-heading">Dice Roller</div>
    <div class="page-sub">Quick rolls and custom expressions for any system</div>

    <div class="panel">
      <div class="panel-head">
        <span class="panel-title">Quick Roll</span>
      </div>
      <div class="panel-body">
        <div class="dice-grid" aria-label="Quick dice">
          <button class="dice-btn" type="button" onclick="quickRoll(4)">d4</button>
          <button class="dice-btn" type="button" onclick="quickRoll(6)">d6</button>
          <button class="dice-btn" type="button" onclick="quickRoll(8)">d8</button>
          <button class="dice-btn" type="button" onclick="quickRoll(10)">d10</button>
          <button class="dice-btn" type="button" onclick="quickRoll(12)">d12</button>
          <button class="dice-btn" type="button" onclick="quickRoll(20)">d20</button>
        </div>

        <label class="field-label" for="expression">Custom expression</label>
        <input class="field-input" id="expression" placeholder="e.g. 2d6+3, 1d20+5" autocomplete="off" spellcheck="false" />
        <div class="roll-row">
          <div class="field-hint">Format: NdS+M &mdash; examples: d20, 2d6+3, 4d8-2</div>
          <button class="roll-btn" type="button" onclick="rollExpression()">Roll</button>
        </div>

        <div class="result-wrap" id="result-wrap" style="display:none;">
          <div class="result-total" id="result"></div>
          <div class="result-detail" id="result-detail"></div>
        </div>
      </div>
    </div>

    <div class="panel">
      <div class="panel-head">
        <span class="panel-title">Roll History</span>
        <button class="hist-clear-btn" type="button" onclick="clearHistory()">Clear</button>
      </div>
      <div class="panel-body">
        <div id="history"></div>
        <div class="field-hint" style="margin-top:10px;">History is stored locally in your browser.</div>
      </div>
    </div>

  </div>
  <footer class="site-footer">
    <p>All content derived from the D&amp;D 5e Systems Reference Document (SRD 5.1). For use by players and Dungeon Masters at the table.</p>
  </footer>
</div>

<script>
function openNav(){document.getElementById('nav-drawer').classList.add('open');document.getElementById('nav-overlay').classList.add('open');document.body.style.overflow='hidden';}
function closeNav(){document.getElementById('nav-drawer').classList.remove('open');document.getElementById('nav-overlay').classList.remove('open');document.body.style.overflow='';}
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeNav();});

function randomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min;}

function stamp(){
  const d=new Date();
  return d.toLocaleDateString('en-GB',{day:'2-digit',month:'short',year:'numeric'})+', '+d.toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});
}

function quickRoll(sides){
  const roll=randomInt(1,sides);
  displayResult({total:roll,expr:'1d'+sides,rolls:[roll],modifier:0});
}

function rollExpression(){
  const exprRaw=document.getElementById('expression').value.trim().toLowerCase();
  const expr=exprRaw.replace(/\s+/g,'');
  const match=expr.match(/^(\d*)d(\d+)([+-]\d+)?$/);
  if(!match){alert('Invalid expression. Example: 2d6+3');return;}
  const count=match[1]?parseInt(match[1],10):1;
  const sides=parseInt(match[2],10);
  const modifier=match[3]?parseInt(match[3],10):0;
  if(count<1||count>200){alert('Dice count must be between 1 and 200.');return;}
  if(sides<2||sides>1000000){alert('Sides must be between 2 and 1,000,000.');return;}
  const rolls=[];
  for(let i=0;i<count;i++)rolls.push(randomInt(1,sides));
  const total=rolls.reduce((a,b)=>a+b,0)+modifier;
  displayResult({total,expr:exprRaw||expr,rolls,modifier});
}

function displayResult({total,expr,rolls,modifier}){
  const wrap=document.getElementById('result-wrap');
  const res=document.getElementById('result');
  const det=document.getElementById('result-detail');
  wrap.style.display='block';
  res.textContent=total;
  res.classList.remove('roll-flash');
  void res.offsetWidth;
  res.classList.add('roll-flash');
  const modTxt=modifier?(' '+(modifier>0?'+':'')+modifier):'';
  det.textContent=rolls.length>1?expr+modTxt+' \u2192 ['+rolls.join(', ')+']':expr;

  const histDiv=document.getElementById('history');
  // remove empty state
  const empty=histDiv.querySelector('.hist-empty');
  if(empty)empty.remove();

  const item=document.createElement('div');
  item.className='history-item';
  item.innerHTML=stamp()+'&nbsp; &bull; &nbsp;'+expr+modTxt+'&nbsp; &rarr; &nbsp;<span class="hist-total">'+total+'</span>&nbsp;&nbsp;<span style="color:var(--text-dim);font-size:0.8rem;">['+rolls.join(', ')+']</span>';
  histDiv.prepend(item);
  localStorage.setItem('diceHistory_v2',histDiv.innerHTML);
}

function clearHistory(){
  const histDiv=document.getElementById('history');
  histDiv.innerHTML='<div class="hist-empty">No rolls yet.</div>';
  localStorage.removeItem('diceHistory_v2');
}

window.addEventListener('load',()=>{
  const saved=localStorage.getItem('diceHistory_v2');
  const histDiv=document.getElementById('history');
  if(saved){histDiv.innerHTML=saved;}
  else{histDiv.innerHTML='<div class="hist-empty">No rolls yet.</div>';}
  document.getElementById('expression').addEventListener('keydown',e=>{if(e.key==='Enter')rollExpression();});
});
</script>
</body>
</html>
